{
  "_comment": "AMP Laydowns Automation - Master Configuration",
  "_version": "2.0.0",
  "_last_updated": "2025-10-07",
  "_description": "Consolidated configuration file for all AMP automation settings",
  "project": {
    "name": "AMP Laydowns Automation",
    "version": "1.0.0",
    "description": "Excel to PowerPoint automation for Annual Marketing Plan presentations",
    "author": "AMP Development Team",
    "last_updated": "2025-10-07"
  },
  "paths": {
    "input": {
      "base": "input",
      "excel": "input/excel",
      "templates": "template",
      "auto_create": true
    },
    "output": {
      "base": "output",
      "presentations": "output/presentations",
      "reports": "output/reports",
      "create_timestamped_folders": true,
      "folder_pattern": "run_{timestamp}",
      "timestamp_format": "%Y%m%d_%H%M%S",
      "auto_create": true,
      "max_runs_to_keep": 20
    },
    "logs": {
      "base": "logs",
      "production": "logs/production",
      "errors": "logs/errors",
      "performance": "logs/performance",
      "auto_create": true,
      "max_log_age_days": 30,
      "auto_cleanup": true
    },
    "backup": {
      "base": ".backup",
      "auto_create": true,
      "enabled": false
    },
    "temp": {
      "base": "temp",
      "auto_create": true,
      "auto_cleanup_on_exit": true
    }
  },
  "script": {
    "name": "excel_to_ppt_v1_071025.py",
    "location": "scripts/excel_to_ppt_v1_071025.py",
    "description": "Main production script for Excel to PowerPoint conversion"
  },
  "template": {
    "current": "Template_V4_FINAL_071025.pptx",
    "location": "template/Template_V4_FINAL_071025.pptx",
    "version": "v4",
    "slide_size": {
      "width_inches": 10.0,
      "height_inches": 5.625,
      "aspect_ratio": "16:9"
    },
    "validation": {
      "check_exists": true,
      "check_structure": true,
      "required_shapes": [
        "Table Placeholder 1"
      ]
    }
  },
  "presentation": {
    "table": {
      "max_rows_per_slide": 40,
      "split_strategy": "by_campaign",
      "smart_pagination_enabled": true,
      "show_charts_on_splits": "all",
      "show_carried_subtotal": true,
      "continuation_indicator": " (Continued)",
      "styling": {
        "column_alignment": {
          "0": "left",
          "1": "left",
          "2": "left",
          "3-14": "right",
          "15": "right",
          "16": "center",
          "17": "center"
        },
        "word_wrap_columns": [],
        "shrink_to_fit_columns": [
          0,
          1,
          2
        ],
        "uppercase_columns": [
          0,
          1
        ],
        "dual_line_labels": {}
      },
      "row_heights": {
        "header_inches": 0.176869,
        "body_inches": 0.001,
        "subtotal_inches": 0.001,
        "header_emu": 161729,
        "body_emu": 914,
        "subtotal_emu": 914,
        "trailer_emu": 0
      },
      "column_widths_emu": [
        812364,
        729251,
        831384,
        338274,
        400567,
        400567,
        400567,
        414770,
        415954,
        465506,
        437595,
        443865,
        400567,
        437595,
        352043,
        449092,
        400567,
        400567
      ],
      "column_widths_inches": [
        0.888412,
        0.797519,
        0.909213,
        0.369941,
        0.438065,
        0.438065,
        0.438065,
        0.453598,
        0.454893,
        0.509084,
        0.47856,
        0.485417,
        0.438065,
        0.47856,
        0.384999,
        0.491133,
        0.438065,
        0.438065
      ],
      "positioning": {
        "left_inches": 0.179,
        "top_inches": 0.698,
        "width_inches": 9.33,
        "height_inches": 3.757102
      }
    },
    "fonts": {
      "default_family": "Calibri",
      "table_family": "Verdana",
      "legend_family": "Verdana",
      "fallback_family": "Arial",
      "sizes_pt": {
        "title": 11,
        "header": 7,
        "body": 6,
        "body_compact": 6,
        "chart_title": 8,
        "chart_labels": 6,
        "legend": 6,
        "comments": 9
      },
      "validation": {
        "check_availability": true,
        "use_fallback_if_missing": true
      }
    },
    "colors": {
      "media_types": {
        "television": {
          "rgb": [
            211,
            254,
            201
          ],
          "hex": "#D3FEC9"
        },
        "digital": {
          "rgb": [
            253,
            242,
            183
          ],
          "hex": "#FDF2B7"
        },
        "ooh": {
          "rgb": [
            255,
            217,
            97
          ],
          "hex": "#FFD961"
        },
        "other": {
          "rgb": [
            176,
            211,
            255
          ],
          "hex": "#B0D3FF"
        }
      },
      "ui_elements": {
        "header_green": {
          "rgb": [
            56,
            236,
            4
          ],
          "hex": "#38EC04"
        },
        "table_gray": {
          "rgb": [
            191,
            191,
            191
          ],
          "hex": "#BFBFBF"
        },
        "subtotal_gray": {
          "rgb": [
            217,
            217,
            217
          ],
          "hex": "#D9D9D9"
        },
        "comments_gray": {
          "rgb": [
            242,
            242,
            242
          ],
          "hex": "#F2F2F2"
        }
      }
    },
    "layout": {
      "frame_shape": "Freeform: Shape 14",
      "slide_number_placeholder": "Slide Number Placeholder 5",
      "legend_groups": {
        "television": {
          "group_shape": "Group 15",
          "color_shape": "TelevisionLegendColor",
          "text_shape": "TelevisionLegendText",
          "position": {
            "left_inches": 6.478,
            "top_inches": 0.313,
            "width_inches": 0.539,
            "height_inches": 0.219
          }
        },
        "digital": {
          "group_shape": "Group 1",
          "color_shape": "DigitalLegendColor",
          "text_shape": "DigitalLegendText",
          "position": {
            "left_inches": 7.088,
            "top_inches": 0.313,
            "width_inches": 0.868,
            "height_inches": 0.219
          }
        },
        "ooh": {
          "group_shape": "Group 4",
          "color_shape": "OOHLegendColor",
          "text_shape": "OOHLegendText",
          "position": {
            "left_inches": 8.027,
            "top_inches": 0.313,
            "width_inches": 0.648,
            "height_inches": 0.219
          }
        },
        "other": {
          "group_shape": "Group 13",
          "color_shape": "OtherLegendColor",
          "text_shape": "OtherLegendText",
          "position": {
            "left_inches": 8.745,
            "top_inches": 0.313,
            "width_inches": 0.767,
            "height_inches": 0.219
          }
        }
      }
    },
    "charts": {
      "enabled": false,
      "positioning": {},
      "types": [],
      "show_on_all_slides": false
    },
    "title": {
      "shape": "TitlePlaceholder",
      "positioning": {
        "left_inches": 0.184,
        "top_inches": 0.27,
        "width_inches": 2.944,
        "height_inches": 0.337
      },
      "format": "{market} - {brand}"
    },
    "comments": {
      "enabled": false,
      "title_shape": "CommentsTitle",
      "box_shape": "CommentsBox",
      "title_positioning": {},
      "box_positioning": {}
    },
    "summary_tiles": {
      "_comment": "Brand-level indicators (quarters, media share, funnel stage) appear ONLY on the LAST slide of each brand",
      "_scope": "brand",
      "_scope_options": ["brand", "campaign", "slide"],
      "_scope_description": "Controls calculation scope for all indicators. Currently only 'brand' is implemented.",
      "quarter_budgets": {
        "_comment": "Quarter budget totals (Q1-Q4) calculated at brand level across all campaigns",
        "_calculation": "Q1 = Jan+Feb+Mar, Q2 = Apr+May+Jun, Q3 = Jul+Aug+Sep, Q4 = Oct+Nov+Dec",
        "_display": "Only shown on the LAST slide when brand spans multiple slides",
        "q1": {
          "shape": "QuarterBudgetQ1",
          "label": "Q1",
          "prefix": "Q1: ",
          "number_format": "\u00a3{value:,.0f}K",
          "scale": 0.001,
          "use_smart_format": true,
          "position": {
            "left_inches": 2.758,
            "top_inches": 4.881,
            "width_inches": 1.239,
            "height_inches": 0.128
          }
        },
        "q2": {
          "shape": "QuarterBudgetQ2",
          "label": "Q2",
          "prefix": "Q2: ",
          "number_format": "\u00a3{value:,.0f}K",
          "scale": 0.001,
          "use_smart_format": true,
          "position": {
            "left_inches": 4.047,
            "top_inches": 4.881,
            "width_inches": 1.239,
            "height_inches": 0.128
          }
        },
        "q3": {
          "shape": "QuarterBudgetQ3",
          "label": "Q3",
          "prefix": "Q3: ",
          "number_format": "\u00a3{value:,.0f}K",
          "scale": 0.001,
          "use_smart_format": true,
          "position": {
            "left_inches": 5.336,
            "top_inches": 4.881,
            "width_inches": 1.239,
            "height_inches": 0.128
          }
        },
        "q4": {
          "shape": "QuarterBudgetQ4",
          "label": "Q4",
          "prefix": "Q4: ",
          "number_format": "\u00a3{value:,.0f}K",
          "scale": 0.001,
          "use_smart_format": true,
          "position": {
            "left_inches": 6.625,
            "top_inches": 4.881,
            "width_inches": 1.239,
            "height_inches": 0.128
          }
        }
      },
      "media_share": {
        "_comment": "Media share percentages calculated at brand level across all campaigns",
        "_calculation": "(media_type_budget / total_brand_budget) * 100",
        "_display": "Only shown on the LAST slide when brand spans multiple slides",
        "television": {
          "shape": "MediaShareTelevision",
          "label": "TV",
          "number_format": "{value:.0f}%",
          "scale": 100,
          "position": {
            "left_inches": 0.179,
            "top_inches": 5.136,
            "width_inches": 1.239,
            "height_inches": 0.128
          }
        },
        "digital": {
          "shape": "MediaShareDigital",
          "label": "DIG.",
          "number_format": "{value:.0f}%",
          "scale": 100,
          "position": {
            "left_inches": 1.469,
            "top_inches": 5.136,
            "width_inches": 1.239,
            "height_inches": 0.128
          }
        },
        "other": {
          "shape": "MediaShareOther",
          "label": "OTHER",
          "number_format": "{value:.0f}%",
          "scale": 100,
          "position": {
            "left_inches": 2.758,
            "top_inches": 5.136,
            "width_inches": 1.239,
            "height_inches": 0.128
          }
        }
      },
      "funnel_share": {
        "_comment": "Funnel stage percentages calculated at brand level across all campaigns",
        "_calculation": "(funnel_stage_budget / total_brand_budget) * 100",
        "_display": "Only shown on the LAST slide when brand spans multiple slides",
        "awareness": {
          "shape": "FunnelShareAwareness",
          "label": "AWA",
          "number_format": "{value:.0f}%",
          "scale": 100,
          "position": {
            "left_inches": 6.028,
            "top_inches": 5.136,
            "width_inches": 1.124,
            "height_inches": 0.128
          }
        },
        "consideration": {
          "shape": "FunnelShareConsideration",
          "label": "CON",
          "number_format": "{value:.0f}%",
          "scale": 100,
          "position": {
            "left_inches": 7.206,
            "top_inches": 5.136,
            "width_inches": 1.124,
            "height_inches": 0.128
          }
        },
        "purchase": {
          "shape": "FunnelSharePurchase",
          "label": "PUR",
          "number_format": "{value:.0f}%",
          "scale": 100,
          "position": {
            "left_inches": 8.385,
            "top_inches": 5.136,
            "width_inches": 1.124,
            "height_inches": 0.128
          }
        }
      },
      "footer_notes": {
        "shape": "FooterNotes",
        "default_text": "Source: DD-MM-YY Lumina Export.\nNote: Digital Reach only for TOP channels and Awareness stage only. Cost: ALL digital channels",
        "append_date": true,
        "append_date_format": "%d-%m-%y",
        "position": {
          "left_inches": 0.088,
          "top_inches": 5.304,
          "width_inches": 3.585,
          "height_inches": 0.269
        }
      }
    }
  },
  "tooling": {
    "autopptx": {
      "enabled": false,
      "base_slide_index": 0,
      "output_suffix": "_autopptx",
      "table_font_name": "Calibri",
      "table_font_size": 12
    },
    "aspose": {
      "enabled": false,
      "export_formats": [
        "pdf"
      ],
      "output_subdir": "aspose",
      "timeout_seconds": 120,
      "client_id": null,
      "client_secret": null
    },
    "docstrange": {
      "enabled": false,
      "command": "docstrange",
      "output_subdir": "docstrange",
      "format": "markdown",
      "reference_template": null
    }
  },
  "data": {
    "excel": {
      "required_columns": {
        "geography": 10,
        "brand": 17,
        "media_type": 20,
        "campaign_names": 83,
        "campaign_type": 84,
        "funnel_stage": 95,
        "net_cost": 71,
        "national_grp": 55,
        "reach_1plus": 104,
        "frequency": 105,
        "year": 15,
        "flight_start_date": 110
      },
      "column_mapping_notes": {
        "_comment": "Column indices corrected on 2025-08-28",
        "changes": [
          "Campaign Names: 85 -> 83",
          "Campaign Type: 86 -> 84",
          "Funnel Stage: 97 -> 95",
          "Net Cost: 73 -> 71",
          "National GRP: 56 -> 55",
          "Reach 1+: 106 -> 104",
          "Frequency: 107 -> 105"
        ]
      },
      "validation": {
        "check_required_columns": true,
        "min_rows": 1,
        "max_file_size_mb": 500
      }
    },
    "geography": {
      "extraction_method": "hierarchical",
      "separator": " | ",
      "extract_position": "last",
      "example": "Global | EMEA | MEA | Pakistan -> Pakistan"
    },
    "media_types": {
      "recognized": [
        "Television",
        "TV",
        "Digital",
        "OOH",
        "Other",
        "Print",
        "Radio",
        "Cinema"
      ],
      "mapping": {
        "Television": "TV",
        "TV": "TV",
        "Digital": "Digital",
        "OOH": "OOH",
        "Other": "Other",
        "Print": "Other",
        "Radio": "Other",
        "Cinema": "Other"
      }
    },
    "sorting": {
      "slides_by": "total_investment",
      "campaigns_by": "net_cost",
      "order": "descending"
    },
    "product_split": {
      "_comment": "Brands listed here will have additional product-level slides generated after the main brand slides",
      "_description": "For each brand listed, the main brand slide acts as a section header, followed by individual slides for each product",
      "enabled": true,
      "brands": [
        "Panadol Pain",
        "Panadol C&F",
        "Parodontax",
        "Sensodyne",
        "Sensodyne Pronamel"
      ],
      "product_rename": {
        "_comment": "Rename products that have same name as brand to avoid confusion",
        "Parodontax": "Parodontax Product",
        "Sensodyne": "Sensodyne Product"
      },
      "delimiter_style": {
        "background_color": [85, 85, 85],
        "text_color": [255, 255, 255],
        "font_size_pt": 32,
        "prefix": "Product: ",
        "brand_title": {
          "enabled": true,
          "font_size_pt": 36,
          "text_color": [255, 255, 255]
        }
      }
    }
  },
  "processing": {
    "max_errors": 15,
    "continue_on_error": false,
    "zero_threshold": 0.01,
    "validation": {
      "enabled": true,
      "min_data_rows": 1,
      "required_data_percentage": 40
    }
  },
  "performance": {
    "execution_time_limits_seconds": {
      "data_loading": 30,
      "data_processing": 60,
      "presentation_generation": 120,
      "chart_creation": 30,
      "table_formatting": 45,
      "slide_creation": 10,
      "total_execution": 1800
    },
    "memory": {
      "max_memory_mb": 2048,
      "warning_threshold_mb": 1500,
      "critical_threshold_mb": 2000,
      "growth_threshold_mb": 500,
      "leak_detection_mb": 100
    },
    "cpu": {
      "max_cpu_percent": 85.0,
      "warning_threshold_percent": 70.0,
      "sustained_duration_seconds": 300.0
    },
    "monitoring": {
      "enabled": true,
      "log_to_file": true,
      "track_operations": [
        "data_loading",
        "data_processing",
        "presentation_generation",
        "full_processing"
      ]
    },
    "optimization": {
      "enable_gc": true,
      "gc_threshold": 100,
      "enable_chunking": false,
      "chunk_size": 10000
    }
  },
  "logging": {
    "level": "INFO",
    "levels": {
      "production": "INFO",
      "development": "DEBUG",
      "testing": "DEBUG"
    },
    "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    "console_output": true,
    "file_output": true,
    "filename_pattern": "amp_automation_{timestamp}.log",
    "max_log_file_size_mb": 50,
    "backup_count": 5,
    "log_to_separate_files": {
      "errors": true,
      "performance": true
    }
  },
  "output": {
    "filename": {
      "pattern": "AMP_Laydowns_{timestamp}.pptx",
      "timestamp_format": "%d%m%y",
      "sanitize_names": true,
      "max_length": 255
    },
    "location": {
      "use_timestamped_folders": true,
      "create_subfolder_per_run": true,
      "organize_by_date": false
    },
    "backup": {
      "create_backup": false,
      "backup_existing": false
    },
    "metadata": {
      "save_metadata_json": true,
      "include_processing_stats": true,
      "include_data_summary": true
    }
  },
  "error_handling": {
    "continue_on_non_critical_errors": true,
    "max_consecutive_errors": 5,
    "log_full_traceback": true,
    "create_error_report": true,
    "error_report_location": "logs/errors"
  },
  "features": {
    "table_splitting": true,
    "geography_processing": true,
    "tv_metrics": true,
    "chart_generation": true,
    "investment_sorting": true,
    "continuation_slides": true,
    "comments_section": true,
    "legend_generation": true,
    "clone_pipeline_enabled": true
  },
  "platform": {
    "current": "windows",
    "font_fallback_enabled": true,
    "path_normalization": true,
    "case_sensitive": false,
    "max_path_length": 260,
    "long_path_support_required": true
  },
  "defaults": {
    "encoding": "utf-8",
    "decimal_precision": 2,
    "date_format": "%Y-%m-%d",
    "currency_symbol": "$",
    "thousands_separator": ",",
    "decimal_separator": "."
  },
  "startup": {
    "verify_dependencies": true,
    "check_paths": true,
    "create_missing_folders": true,
    "validate_template": true,
    "cleanup_temp_on_start": false,
    "show_banner": true
  },
  "shutdown": {
    "cleanup_temp_files": true,
    "save_session_log": true,
    "create_final_report": false
  },
  "development": {
    "debug_mode": false,
    "verbose_output": false,
    "save_intermediate_data": false,
    "skip_validation": false,
    "dry_run_mode": false
  }
}
