# 23 Oct 2025 - Start-of-Day Summary

## Highlights
- `D:\Drive\projects\work\AMP Laydowns Automation\tools\PostProcessCampaignMerges.ps1` gained fixed-layout handling, span normalisation, and timeout guards; verbose logs are captured under `docs\23-10-25\logs\02-04-postprocess_run_*.log`.
- Handoff log `docs\23-10-25\logs\05-postprocess_hand_off.md` documents the four failed post-process attempts plus required clean-up steps for the next agent.
- Created `tools\SanitizePrimaryColumns.ps1` and `tools\RebuildCampaignMerges.ps1` prototypes for a sanitize-first pipeline and preserved the trusted deck at `output\presentations\baseline_20251022\GeneratedDeck_20251022_160155_baseline.pptx` for safe diffing.

## Blockers / Risks
- The deck at `output\presentations\run_20251022_164818\GeneratedDeck_20251022_164818.pptx` is corrupted by legacy merges (vertical spans in the hundreds of rows); the current post-process script cannot recover it.
- No row-height probe artefact exists for a clean deck, and Slide 1/visual diff evidence remains blocked until a fresh run succeeds.
- COM automation now exits cleanly, but without geometry sanitisation prior to merging we will continue to hit `Cell.Split : Illegal value` on legacy decks.
- CLI deck regeneration currently hits the 10-minute timeout because presentation assembly emits hundreds of thousands of `[DEBUG]` lines; logging must be toned down before another run.

## Repository Map
- `D:\Drive\projects\work\AMP Laydowns Automation\tools\PostProcessCampaignMerges.ps1` – updated today with `Set-CellFixedLayout`, `Normalize-TableLayout`, `Reset-PrimaryColumnSpans`, residual span logging, and stricter iteration caps. Needs retest on a regenerated deck.
- `D:\Drive\projects\work\AMP Laydowns Automation\docs\23-10-25\logs\05-postprocess_hand_off.md` – new summary log covering the failed attempts, process terminations, and next-step guidance.
- `D:\Drive\projects\work\AMP Laydowns Automation\docs\22-10-25\logs\` – still the canonical reference for pre-failure deck regeneration and COM troubleshooting.
- `D:\Drive\projects\work\AMP Laydowns Automation\tools\SanitizePrimaryColumns.ps1` / `tools\RebuildCampaignMerges.ps1` – prototype sanitize-first utilities subject to baseline validation.
- `D:\Drive\projects\work\AMP Laydowns Automation\output\presentations\baseline_20251022\` – preserved clean deck for comparison while the pipeline remains unstable.

## Next Focus
1. Regenerate a fresh baseline deck via the CLI (`python -m amp_automation.cli.main ...`) and archive the new run ID under `docs\23-10-25\logs\`.
2. Build or reuse a “geometry sanitizer” that unmerges columns 1-3 for every slide before invoking `tools\PostProcessCampaignMerges.ps1`; confirm sanitised deck integrity.
3. Re-run the post-process script on the clean deck, inspect residual span warnings, then capture COM row-height probe output under `docs\23-10-25\artifacts\`.
4. Once row heights hold at 8.4 ± 0.1 pt, resume Slide 1 visual diff / Zen MCP evidence collection and extend automated regression checks for merge enforcement.
